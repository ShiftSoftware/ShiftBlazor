@namespace ShiftSoftware.ShiftBlazor.Components.ShiftList.Filters

@if (Parent?.Filters != null)
{
    @foreach (var (id, filter) in Parent.Filters)
    {
        <MudStack Row @key="id">

            @if (!filter.IsHidden)
            {
                <MudField Variant="Variant.Outlined" Label="@filter.Field" Disabled="filter.IsReadOnly">
                    <CascadingValue Name="@FormHelper.ParentDisabledName" Value="filter.IsReadOnly">
                        <MudStack Row AlignItems="AlignItems.End" Spacing="2">

                            @if (filter is _BooleanFilter booleanFilter)
                            {
                                <BooleanFilterInput Filter="filter" />
                            }
                            else if (filter is _StringFilter stringFilter)
                            {
                                <StringFilterInput Filter="filter" />
                            }
                            else if (filter is _EnumFilter enumFilter && enumFilter.EnumTypeToUse != null)
                            {
                                <EnumFilterInput Filter="filter" EnumType="enumFilter.EnumType" />
                            }
                            else if (filter is _DateFilter dateFilter)
                            {
                                <DateFilterInput Filter="filter" />
                            }
                            else if (filter is _NumericFilter)
                            {
                                <NumericFilterInput Filter="filter" />
                            }

                        </MudStack>
                    </CascadingValue>
                </MudField>
            }

            <MudIconButton Icon="@Icons.Material.Filled.Close" OnClick="@(() => RemoveFilterComponent(id))" />
        </MudStack>
    }

}

@FilterTempalte

@if (DTO != null)
{
    <MudMenu>
        <ActivatorContent>
            <MudButton>Add</MudButton>
        </ActivatorContent>
        <ChildContent>

            @foreach (var field in Fields)
            {
                <MudMenuItem OnClick="() => AddFilter(field)">@field.Name</MudMenuItem>
            }
        </ChildContent>
    </MudMenu>
}