@inherits MudDatePicker

@namespace ShiftSoftware.ShiftBlazor.Components

@{
    base.BuildRenderTree(__builder);
}

@code {
    [CascadingParameter]
    public IFormSection? FormSection { get; set; }

    private bool FirstRun = true;

    public override Task SetParametersAsync(ParameterView parameters)
    {
        if (FirstRun)
        {
            FirstRun = false;
            if (parameters.TryGetValue(nameof(For), out System.Linq.Expressions.Expression<Func<DateTime?>>? _For))
            {
                Required = FormHelper.IsRequired(_For!);
            }
        }

        return base.SetParametersAsync(parameters);
    }

    override protected void OnInitialized()
    {
        if (For != null && FormSection != null)
        {
            FormSection.Add(Microsoft.AspNetCore.Components.Forms.FieldIdentifier.Create(For));

        }
        base.OnInitialized();
    }
}