@inherits MudButton
@namespace ShiftSoftware.ShiftBlazor.Components
@implements IDisposable

<MudBadge Content="@IShortcutComponent.CleanKeyName(KeyboardKey.ToString()!)"
          Origin="Origin.CenterCenter"
          BadgeClass="shortcut-key-badge"
          Visible="KeyboardKey != null && !(ShiftEntityForm is IShortcutComponent comp && ShiftList != null)">

    @{
        base.BuildRenderTree(__builder);
    }
</MudBadge>

@code {
    [CascadingParameter(Name = "ShiftForm")]
    public ComponentBase? ShiftEntityForm { get; set; }

    [CascadingParameter]
    public IShiftList? ShiftList { get; set; }

    [Parameter]
    public KeyboardKeys? KeyboardKey { get; set; }

    protected override void OnInitialized()
    {
        base.OnInitialized();

        if (KeyboardKey != null && ShiftEntityForm is IShortcutComponent comp && ShiftList == null)
        {
            comp?.Shortcuts.TryAdd(KeyboardKey.Value, OnClick);
        }
    }

    public void Dispose()
    {
        if (KeyboardKey != null && ShiftEntityForm is IShortcutComponent comp && ShiftList == null)
        {
            comp?.Shortcuts.Remove(KeyboardKey.Value);
        }
    }
}