@using ShiftSoftware.ShiftBlazor.Enums
@typeparam T
@inherits MudAutocomplete<T>
@namespace ShiftSoftware.ShiftBlazor.Components

@{
    base.ReadOnly = Mode < FormModes.Edit;
    base.Disabled = TaskInProgress != null && TaskInProgress != FormTasks.None;

    if (AdornmentIconIsNotSet)
    {
        base.AdornmentIcon = Value == null ? Icons.Material.Filled.AddCircle : Icons.Material.Filled.Edit;
    }
    if (AdornmentAriaLabelIsNotSet)
    {
        base.AdornmentAriaLabel = "Add new item";
    }
    if (OnAdornmentClickIsNotSet)
    {
        var key = Value?.GetType().GetProperty("ID")?.GetValue(Value);
        base.OnAdornmentClick = new EventCallback<MouseEventArgs>(this, () => AddEditItem(key));
    }

    base.ProgressIndicatorInPopoverTemplate =
    @<MudList Clickable="false">
        <MudListItem>
            Loading...
        </MudListItem>
    </MudList>;

    base.NoItemsTemplate =
    @<MudText Align="Align.Center" Class="px-4 py-1">
        @if (QuickAddComponentType == null)
        {
            <text>No Items Found</text>
        }
        else
        {
            <MudButton OnClick="() => { _ = AddEditItem(); base.Clear();}">No Items Found, Add New</MudButton>
        }
    </MudText>;

    base.BuildRenderTree(__builder);
}