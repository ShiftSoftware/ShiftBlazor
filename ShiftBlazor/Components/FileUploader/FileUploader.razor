@namespace ShiftSoftware.ShiftBlazor.Components
@using Microsoft.AspNetCore.Components.Forms
@inject IStringLocalizer<Resources.Components.FileUploader> Loc

@inherits Events.EventComponentBase
@implements IDisposable

<MudField id="@UploaderId" Label="@Label" Class="@("FileUpload relative my-4 z-10" + (ReadOnly ? " readonly" : ""))" Variant="Variant.Outlined">

    @if (Items.Count > 0 || !ReadOnly)
    {
        <MudGrid Spacing="@(ShowThumbnail ? 2 : 1)">
            <CascadingValue Value="this" IsFixed="true">
                @foreach (var item in Items)
                {
                    <MudItem @key="item.Id" Style="cursor: grab;" data-guid="@item.Id">
                        @if (ShowThumbnail)
                        {

                            <UploaderItemThumbnail Item="@item" Height="@ThumbnailSize" Width="@ThumbnailSize"></UploaderItemThumbnail>
                        }
                        else
                        {
                            <UploaderItemChip Item="@item"></UploaderItemChip>
                        }
                    </MudItem>
                }
            </CascadingValue>

            @if (!ReadOnly)
            {
                <MudItem @key="@("add-file")" Class="add-file">
                    @if (ShowThumbnail)
                    {
                        <MudIconButton OnClick="OpenInput" Icon="@Icons.Material.Filled.Add" Size="Size.Large" Variant="Variant.Filled" Style=@($"width: {ThumbnailSize}px;height: {ThumbnailSize}px;")></MudIconButton>
                    }
                    else
                    {
                        <MudChip Icon="@Icons.Material.Filled.Add" OnClick="OpenInput">@Loc["AddChipButton"]</MudChip>
                    }
                </MudItem>
            }
        </MudGrid>
        <InputFile id="@InputId" OnChange="OnInputFileChanged" hidden multiple accept="@InputAccept" />

    }
    else
    {
        <MudText Typo="Typo.h6">@Loc["NoFilesSelected"]</MudText>
    }
</MudField>
